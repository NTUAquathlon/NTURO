<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="NTURO Team Registration">
    <meta name="author" content="NTU Aquathlon">
    <meta name="generator" content="Jekyll v3.8.5">
    <title>NTURO Registration - Payment</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" crossorigin="anonymous"></script>
    <style>
      .card{
        margin-top:20px;
        margin-bottom:20px;
      }
    </style>
  </head>
  <body>
  <div class="container">
    <div class="py-5 text-center">
      <a href="/">
        <img class="d-block mx-auto mb-4" src="images/logo/logo.png" alt="NTURO" class="img-fluid" width="72" height="72">
      </a>
      <h2>Payment</h2>
    </div>
    <div class="card">
      <div class="card-header">
        Online Payment
      </div>
      <div class="card-body">
        <h5 class="card-title">Payment by Xfers</h5>
        <p class="card-text">Xfers will provide you with a bank account number to start the payment process.</p>
        <a href="#" id="pay" class="btn btn-primary">Pay</a>
      </div>
    </div>
    <div class="row" style="text-align:center;padding: 20px">
      <div class=" col-md-12">
        <h1 style="text-align:center;">OR</h1>
      </div>
    </div>
    <div class="card">
      <div class="card-header">
        Paynow Payment
      </div>
      <div class="card-body">
        <h5 class="card-title">Payment via Paynow</h5>
        <div class="card-text">
          The transfer details are as follows:<br />
          <br />
          <div class="table-responsive">
            <table class="table">
              <tbody>
              <tr>
                <th>Name of Receipient</th>
                <td>Adrian Lim</td>
              </tr>
              <tr>
                <th>Phone Number</th>
                <td>+65-96852774</td>
              </tr>
              <tr>
                <th>Amount</th>
                <td class="amount"></td>
              </tr>
              <tr>
                <th>Comment</th>
                <td id="name">Enter your name submitted during registration</td>
              </tr>
            </tbody>
            </table>
          </div>
          <br />
          Please enter your name in the comment section so that we can verify the payment.<br />
          <br />
          You will receive a confirmation within 5 working days of your payment.
        </div>
      </div>
    </div>
      
  </div>

  <footer class="py-5 bg-light">
  <div class="container">
  <div class="row">
    <div class="col-3" style="overflow:hidden">
    <div class="float-left">
      <a class="navbar-brand" href="#">
        <img src="images/logo/logo.png" alt="NTURO" class="img-fluid" style="max-height:24px;">
      </a>
    </div>
  </div>
    <small class="col-6 mx-auto text-muted align-self-center" style="text-align:center">Copyright &copy; <script>document.write(new Date().getFullYear())</script>, <a href="https://ntuaquathlon.com">NTU Aquathlon</a></small>


  <div class="col-3" style="overflow:hidden">
    <div class="float-right">
      <a class="navbar-brand" href="https://www.instagram.com/ntuaquathlon/" style="margin-right:0">
        <img src="images/ig.svg" alt="IG Logo" style="max-height:24px;">
      </a>
      <a class="navbar-brand" href="https://www.facebook.com/NTURO" style="margin-right:0">
        <img src="images/fb.svg" alt="FB Logo" style="max-height:24px;">
      </a>
      
    </div>
  </div>

  </div>
  </div>
</footer>

<script>
  function getAllUrlParams(url) {

  // get query string from url (optional) or window
  var queryString = url ? url.split('?')[1] : window.location.search.slice(1);

  // we'll store the parameters here
  var obj = {};

  // if query string exists
  if (queryString) {

    // stuff after # is not part of query string, so get rid of it
    queryString = queryString.split('#')[0];

    // split our query string into its component parts
    var arr = queryString.split('&');

    for (var i = 0; i < arr.length; i++) {
      // separate the keys and the values
      var a = arr[i].split('=');

      // set parameter name and value (use 'true' if empty)
      var paramName = a[0];
      var paramValue = typeof (a[1]) === 'undefined' ? true : a[1];

      // (optional) keep case consistent
      paramName = paramName.toLowerCase();
      if (typeof paramValue === 'string') paramValue = paramValue.toLowerCase();

      // if the paramName ends with square brackets, e.g. colors[] or colors[2]
      if (paramName.match(/\[(\d+)?\]$/)) {

        // create key if it doesn't exist
        var key = paramName.replace(/\[(\d+)?\]/, '');
        if (!obj[key]) obj[key] = [];

        // if it's an indexed array e.g. colors[2]
        if (paramName.match(/\[\d+\]$/)) {
          // get the index value and add the entry at the appropriate position
          var index = /\[(\d+)\]/.exec(paramName)[1];
          obj[key][index] = paramValue;
        } else {
          // otherwise add the value to the end of the array
          obj[key].push(paramValue);
        }
      } else {
        // we're dealing with a string
        if (!obj[paramName]) {
          // if it doesn't exist, create property
          obj[paramName] = paramValue;
        } else if (obj[paramName] && typeof obj[paramName] === 'string'){
          // if property does exist and it's a string, convert it to an array
          obj[paramName] = [obj[paramName]];
          obj[paramName].push(paramValue);
        } else {
          // otherwise add the property
          obj[paramName].push(paramValue);
        }
      }
    }
  }

  return obj;
}

function getQueryVariable(variable)
{
       var query = window.location.search.substring(1);
       var vars = query.split("&");
       for (var i=0;i<vars.length;i++) {
               var pair = vars[i].split("=");
               if(pair[0] == variable){return pair[1];}
       }
       return(false);
}

var code = getQueryVariable("code")

var name = getQueryVariable("name")

if (typeof code != "undefined"){
  $.getJSON('https://ntuaquathlon.azurewebsites.net/promo?code=' + code.toUpperCase(),function(data){

          if(data.StatusCode == 404){
            alert("Error, Please check that you have the right url")
            return;
          }
          document.getElementsByClassName("amount")[0].innerText = "$" + data.Price
          document.getElementById("pay").href = data.URL
          // document.getElementsByClassName("amount")[0].innerText = URL
          
        })

}else{
  console.log("Error, Please check that you have the right url")
}

if (typeof name != "undefined"){
  document.getElementById("name").innerText = decodeURI(name)
}
</script>

</body>